<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title></title>
    <script
      type="text/javascript"
      src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=3bfesa9m72&amp;submodules=geocoder"
    ></script>
    <script
      src="https://code.jquery.com/jquery-3.7.0.min.js"
      integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g="
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <div style="margin-top: 20px; margin-bottom: 10px; font-weight: bold">
      <h1>약국지도</h1>
    </div>
    <div id="map" style="width: 100%; height: 600px"></div>
  </body>
  <script>
    $(document).ready(async function () {
      let XY = await getLocation();
      var mapDiv = document.getElementById("map"); // 'map'으로 선언해도 동일
      var map = new naver.maps.Map(mapDiv);
      $.ajax({
        url: "/pharmacy",
        type: "GET",
        cache: false,
        dataType: "json",
        data: {
          Q0: "서울특별시",
          Q1: "강남구",
          QT: "",
          QN: "",
          ORD: "",
          pageNo: "1",
          numOfRows: "1000",
        },
        success: function (data) {},
        error: function (request, status, error) {},
      });
    });

    async function getLocation() {
      const XY = new Object();
      if (navigator.geolocation) {
        let promise = new Promise((resolve, rejected) => {
          navigator.geolocation.getCurrentPosition((position) => {
            resolve(position);
          });
        });
        let position = await promise;
        XY.lat = position.coords.latitude;
        XY.lng = position.coords.longitude;
        alert("위도" + XY.lat);
        alert("경도" + XY.lng);
      }
      return XY;
    }
  </script>
</html>
